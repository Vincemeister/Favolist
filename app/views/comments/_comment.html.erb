<div class="comment my-2 d-flex w-100 align-items-start" data-comments-count-value="<%= comment.replies.count %>">
  <%= cl_image_tag comment.user.avatar.key, crop: "fill", gravity: "center", aspect_ratio: "1:1", class: "avatar"%>
  <div class="flex-column d-flex ms-3">
    <div class="d-flex justify-content-start align-items-start mb-1">
      <span class="my-0 lh-1.25 w-100">
        <strong><%= comment.user.username %></strong> <%= comment.body %>
      </span>
    </div>
    <div class="d-flex justify-content-start align-items-center flex-wrap mb-2">
      <span class="small-reply"><%= time_ago_in_words(comment.created_at, include_seconds: false).gsub('about', '').gsub(/minute(s)?\s*/, 'm').gsub(/hour(s)?\s*/, 'h').gsub(/day(s)?\s*/, 'd').gsub(' m', 'm').gsub(' h', 'h').gsub(' d', 'd') %></span>


      <a href="#!" class="small-reply mx-2" data-action="click->comments#toggleReplyForm" data-parent-id="<%= comment.id %>">Reply</a>



      <% if comment.user == current_user %>
        <a href="#!" class="small-reply">Delete</a>
      <% end %>
    </div>


    <div class="reply-form d-none" data-comments-target="reply-form" data-parent-id="<%= comment.id %>">
      <%= render 'comments/reply_form', product: @product, comment: Comment.new, parent_comment_id: comment.id, remote: true %>
    </div>



    <% if comment.replies.present? %>
      <div class="first-reply">
        <%= render "comments/reply", reply: comment.replies.last %>
      </div>
      <div class="small-reply mx-2" data-action="click->comments#toggleReplies" data-comments-target="view-replies-button">
        <%="View all #{comment.replies.count} replies" %>
      </div>
      <div class="replies d-none" data-comments-target="replies">
        <% comment.replies.each do |reply| %>
          <%= render "comments/reply", reply: reply, comment: comment %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
